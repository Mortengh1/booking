{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mortengedstedhansen/Documents/Skole/Eksamen 1/booking/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/mortengedstedhansen/Documents/Skole/Eksamen 1/booking/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/mortengedstedhansen/Documents/Skole/Eksamen 1/booking/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useRef,useState,useEffect}from\"react\";import axios from\"../api/axios\";import{useNavigate,useLocation}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LOGIN_URL=\"https://skole.mortengh.dk/PHP/login.php\";var Login=function Login(){var _location$state,_location$state$from;var navigate=useNavigate();var location=useLocation();var from=((_location$state=location.state)===null||_location$state===void 0?void 0:(_location$state$from=_location$state.from)===null||_location$state$from===void 0?void 0:_location$state$from.pathname)||\"/\";var userRef=useRef();var errRef=useRef();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),pwd=_useState4[0],setPwd=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),errMsg=_useState6[0],setErrMsg=_useState6[1];useEffect(function(){userRef.current.focus();},[]);useEffect(function(){setErrMsg(\"\");},[user,pwd]);var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();axios.post(LOGIN_URL,JSON.stringify({mail:user,pwd:pwd})).then(function(result){console.log(result.data);if(result.data.status==\"invalid\"){setErrMsg(result.data.errorMessage);}else{localStorage.setItem(\"userId\",result.data.userId);localStorage.setItem(\"loggedIn\",true);setUser(\"\");setPwd(\"\");navigate(from,{replace:true});window.location.reload();}});case 2:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsx(\"div\",{className:\"LoginContainer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"LoginForm\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Log ind\"}),/*#__PURE__*/_jsx(\"p\",{ref:errRef,className:errMsg?\"ErrorMessage\":\"offScreen\",\"aria-live\":\"assertive\",children:errMsg}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",ref:userRef,onChange:function onChange(e){return setUser(e.currentTarget.value);},value:user,required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Kodeord:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",onChange:function onChange(e){return setPwd(e.currentTarget.value);},value:pwd,required:true}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",children:\"Log ind\"})]})]})})});};export default Login;","map":{"version":3,"names":["useRef","useState","useEffect","axios","useNavigate","useLocation","LOGIN_URL","Login","navigate","location","from","state","pathname","userRef","errRef","user","setUser","pwd","setPwd","errMsg","setErrMsg","current","focus","handleSubmit","e","preventDefault","post","JSON","stringify","mail","then","result","console","log","data","status","errorMessage","localStorage","setItem","userId","replace","window","reload","currentTarget","value"],"sources":["/Users/mortengedstedhansen/Documents/Skole/Eksamen 1/booking/src/pages/Login.js"],"sourcesContent":["import { useRef, useState, useEffect } from \"react\";\n\nimport axios from \"../api/axios\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nconst LOGIN_URL = \"https://skole.mortengh.dk/PHP/login.php\";\n\nconst Login = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const from = location.state?.from?.pathname || \"/\";\n\n  const userRef = useRef();\n  const errRef = useRef();\n\n  const [user, setUser] = useState(\"\");\n  const [pwd, setPwd] = useState(\"\");\n  const [errMsg, setErrMsg] = useState(\"\");\n\n  useEffect(() => {\n    userRef.current.focus();\n  }, []);\n\n  useEffect(() => {\n    setErrMsg(\"\");\n  }, [user, pwd]);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    axios\n      .post(LOGIN_URL, JSON.stringify({ mail: user, pwd }))\n      .then((result) => {\n        console.log(result.data);\n        if (result.data.status == \"invalid\") {\n          setErrMsg(result.data.errorMessage);\n        } else {\n          localStorage.setItem(\"userId\", result.data.userId);\n          localStorage.setItem(\"loggedIn\", true);\n          setUser(\"\");\n          setPwd(\"\");\n          navigate(from, { replace: true });\n          window.location.reload();\n        }\n      });\n  };\n\n  return (\n    <div className=\"App\">\n      <div className=\"LoginContainer\">\n        <div className=\"LoginForm\">\n          <h1>Log ind</h1>\n          <p\n            ref={errRef}\n            className={errMsg ? \"ErrorMessage\" : \"offScreen\"}\n            aria-live=\"assertive\"\n          >\n            {errMsg}\n          </p>\n\n          <form onSubmit={handleSubmit}>\n            <label htmlFor=\"username\">Email:</label>\n            <input\n              type=\"text\"\n              id=\"username\"\n              ref={userRef}\n              onChange={(e) => setUser(e.currentTarget.value)}\n              value={user}\n              required\n            ></input>\n            <label htmlFor=\"password\">Kodeord:</label>\n            <input\n              type=\"password\"\n              id=\"password\"\n              onChange={(e) => setPwd(e.currentTarget.value)}\n              value={pwd}\n              required\n            ></input>\n            <button className=\"btn\">Log ind</button>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n};\nexport default Login;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}