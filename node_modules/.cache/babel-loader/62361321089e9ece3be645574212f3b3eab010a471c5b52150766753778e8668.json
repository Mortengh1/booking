{"ast":null,"code":"var _jsxFileName = \"/Users/mortengedstedhansen/Documents/Skole/Eksamen 1/booking/src/pages/Login.js\",\n  _s = $RefreshSig$();\nimport { useRef, useState, useEffect } from \"react\";\nimport axios from \"../api/axios\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\n//The url to the php file that handles login requests\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LOGIN_URL = \"https://skole.mortengh.dk/PHP/login.php\";\nconst Login = () => {\n  _s();\n  var _location$state, _location$state$from;\n  const navigate = useNavigate();\n  const location = useLocation();\n  //Stores the page the user tried to acces without being logged in\n  const from = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : (_location$state$from = _location$state.from) === null || _location$state$from === void 0 ? void 0 : _location$state$from.pathname) || \"/\";\n  const userRef = useRef();\n  const errRef = useRef();\n  const [user, setUser] = useState(\"\");\n  const [pwd, setPwd] = useState(\"\");\n  const [errMsg, setErrMsg] = useState(\"\");\n\n  //Tells which field to focus\n  useEffect(() => {\n    userRef.current.focus();\n  }, []);\n  useEffect(() => {\n    setErrMsg(\"\");\n  }, [user, pwd]);\n\n  //When submitting the login form, it runs the post request with the mail and password\n  const handleSubmit = async e => {\n    e.preventDefault();\n    axios.post(LOGIN_URL, JSON.stringify({\n      mail: user,\n      pwd\n    })).then(result => {\n      console.log(result.data);\n      if (result.data.status == \"invalid\") {\n        //If the request is invalid, it sets the error message\n        setErrMsg(result.data.errorMessage);\n      } else {\n        //Stores the user id in loaclStoreafe and sets loggedIn to true\n        localStorage.setItem(\"userId\", result.data.userId);\n        localStorage.setItem(\"loggedIn\", true);\n        //Empties the user and password field\n        setUser(\"\");\n        setPwd(\"\");\n        //Navigates to the stored page from earlier\n        navigate(from, {\n          replace: true\n        });\n        //Reloads the site\n        window.location.reload();\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"LoginContainer\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"LoginForm\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Log ind\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          ref: errRef,\n          className: errMsg ? \"ErrorMessage\" : \"offScreen\",\n          \"aria-live\": \"assertive\",\n          children: errMsg\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"username\",\n            children: \"Email:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            id: \"username\",\n            ref: userRef,\n            onChange: e => setUser(e.currentTarget.value),\n            value: user,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"password\",\n            children: \"Kodeord:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            id: \"password\",\n            onChange: e => setPwd(e.currentTarget.value),\n            value: pwd,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            children: \"Log ind\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Har du ikke en bruger? \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 38\n            }, this), \"S\\xE5 registrer dig \", /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"/registration\",\n              children: \"her\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 90,\n              columnNumber: 32\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n};\n_s(Login, \"MRtFOEYHJP8c57TC1DAhDZMiE8Q=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = Login;\nexport default Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["useRef","useState","useEffect","axios","useNavigate","useLocation","LOGIN_URL","Login","navigate","location","from","state","pathname","userRef","errRef","user","setUser","pwd","setPwd","errMsg","setErrMsg","current","focus","handleSubmit","e","preventDefault","post","JSON","stringify","mail","then","result","console","log","data","status","errorMessage","localStorage","setItem","userId","replace","window","reload","currentTarget","value"],"sources":["/Users/mortengedstedhansen/Documents/Skole/Eksamen 1/booking/src/pages/Login.js"],"sourcesContent":["import { useRef, useState, useEffect } from \"react\";\n\nimport axios from \"../api/axios\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\n//The url to the php file that handles login requests\nconst LOGIN_URL = \"https://skole.mortengh.dk/PHP/login.php\";\n\nconst Login = () => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  //Stores the page the user tried to acces without being logged in\n  const from = location.state?.from?.pathname || \"/\";\n\n  const userRef = useRef();\n  const errRef = useRef();\n\n  const [user, setUser] = useState(\"\");\n  const [pwd, setPwd] = useState(\"\");\n  const [errMsg, setErrMsg] = useState(\"\");\n\n  //Tells which field to focus\n  useEffect(() => {\n    userRef.current.focus();\n  }, []);\n\n  useEffect(() => {\n    setErrMsg(\"\");\n  }, [user, pwd]);\n\n  //When submitting the login form, it runs the post request with the mail and password\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    axios\n      .post(LOGIN_URL, JSON.stringify({ mail: user, pwd }))\n      .then((result) => {\n        console.log(result.data);\n        if (result.data.status == \"invalid\") {\n          //If the request is invalid, it sets the error message\n          setErrMsg(result.data.errorMessage);\n        } else {\n          //Stores the user id in loaclStoreafe and sets loggedIn to true\n          localStorage.setItem(\"userId\", result.data.userId);\n          localStorage.setItem(\"loggedIn\", true);\n          //Empties the user and password field\n          setUser(\"\");\n          setPwd(\"\");\n          //Navigates to the stored page from earlier\n          navigate(from, { replace: true });\n          //Reloads the site\n          window.location.reload();\n        }\n      });\n  };\n\n  return (\n    <div className=\"App\">\n      <div className=\"LoginContainer\">\n        <div className=\"LoginForm\">\n          <h1>Log ind</h1>\n          <p\n            ref={errRef}\n            className={errMsg ? \"ErrorMessage\" : \"offScreen\"}\n            aria-live=\"assertive\"\n          >\n            {errMsg}\n          </p>\n\n          <form onSubmit={handleSubmit}>\n            <label htmlFor=\"username\">Email:</label>\n            <input\n              type=\"text\"\n              id=\"username\"\n              ref={userRef}\n              onChange={(e) => setUser(e.currentTarget.value)}\n              value={user}\n              required\n            ></input>\n            <label htmlFor=\"password\">Kodeord:</label>\n            <input\n              type=\"password\"\n              id=\"password\"\n              onChange={(e) => setPwd(e.currentTarget.value)}\n              value={pwd}\n              required\n            ></input>\n            <button className=\"btn\">Log ind</button>\n            <p>\n              Har du ikke en bruger? <br />\n              SÃ¥ registrer dig <a href=\"/registration\">her</a>\n            </p>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n};\nexport default Login;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}